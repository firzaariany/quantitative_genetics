<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Poplar’s behaviors toward different rust types</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Quantitative genetics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="EDA.html">Exploratory data analysis</a>
</li>
<li>
  <a href="preparation_gwas.html">Data cleaning</a>
</li>
<li>
  <a href="pca.html">Principal component analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Poplar’s behaviors toward different rust types</h1>

</div>


<div id="description." class="section level1">
<h1>Description.</h1>
<p>The general aim of the study was to find the genetic potential of black poplar’s resistance (<em>Populus nigra</em>) when they are infected by rust fungi.</p>
<p>Here are the illustrations when black poplar leaves are infected by rust. The picture on the left is an overall infection, and the picture on the right is a zoomed visualization.</p>
<p>Before proceeding to a more sophisticated modeling, I conducted an Exploratory Data Analysis (EDA) to gather the initial insights from the dataset.</p>
<hr />
<p><strong>About the raw dataset and the species used</strong></p>
<p>The raw data consists of the measurement in the lab for poplar resistance.</p>
<p>The variables needed in the analysis were:<br />
- <strong>Latent period, coded as Laten</strong><br />
- <strong>Number of spores, coded as NbSS</strong><br />
- <strong>Size of spores, coded as Taiil</strong></p>
<p>Together, they are called “resistance components”.</p>
<p>The spesies is black poplar (<em>Populus nigra</em>) that was collected from several natural populations and sources in Western Europe.</p>
<p><strong>Experimental design</strong></p>
<p>The experimental design was as follow: 154 poplar individuals spread across 5 blocks were infected with 3 rust types. These make up a total 2520 observations of 15 variables.</p>
<p>Note. not all variables are going to be used, we will see as we proceed through this script.</p>
<p>The objectives of this first step of prelim analysis were:</p>
<div id="objectives" class="section level2">
<h2>Objectives</h2>
<ol style="list-style-type: decimal">
<li>Check the resistant vs susceptible individuals.<br />
</li>
<li>Understand the global distribution of the resistance components.<br />
</li>
<li>Understand the variability in the resistance components between the rust types.</li>
</ol>
</div>
</div>
<div id="preparation-libraries-working-directory-data-set." class="section level1">
<h1>Preparation (libraries, working directory, data set).</h1>
<pre class="r"><code># Libraries
library(plyr)  # Create a frequency table of resistant vs susceptible individuals
library(naniar)  # Replace values with NA
library(ggplot2)  # Make graphs
library(ggpubr)  # Arrange ggplot graphs in columns and rows

# Loading the raw data set ----
rust_test1 = read.delim2(&quot;B4est_test1_LectureJ13_J14_commented.txt&quot;, na = &quot;NA&quot;)

# Selection of columns ----
test1_selec = rust_test1[ ,-c(12, 13, 15)]  # getting only the columns that we need</code></pre>
<p>In the raw dataset I had 15 variables. I did not need all these 15 variables, so for simplicity, I selected only the variables that I needed. The preview of the first 5 observation in the dataset with the variables I needed is shown below:</p>
<pre class="r"><code>head(test1_selec)</code></pre>
<pre><code>##                 Block Strain Genotype X  Y Laten_24.02.15_gp NbSS_24.02.15_gp NbSnS_24.02.15_gp NbSO_24.02.15_gp
## 1 B4est_1_Bloc_1-28x3 09AX27     N-35 1 13              11.0               13                 0                1
## 2 B4est_1_Bloc_1-28x3 09AX27   NOH-13 2 13               9.0                6                 0                8
## 3 B4est_1_Bloc_1-28x3 09AX27      N-1 3 13              13.0                2                 2                6
## 4 B4est_1_Bloc_1-28x3 09AX27    6-A18 4 13               9.5                4                 0                8
## 5 B4est_1_Bloc_1-28x3 09AX27   SSN-01 5 13              12.5                2                 1                6
## 6 B4est_1_Bloc_1-28x3 09AX27   BDX-09 6 13              -5.0                0                 3               11
##   NbPtN_24.02.15_gp Taill_05.08.20_gp points.noirs.avant.le.test
## 1                 0                 5                         NA
## 2                 0                 4                         NA
## 3                 3                 2                         NA
## 4                 0                 5                         NA
## 5                 0                 1                         NA
## 6                 0                 0                         NA</code></pre>
</div>
<div id="checking-the-resistant-vs-susceptible-individuals." class="section level1">
<h1>Checking the resistant vs susceptible individuals.</h1>
<p>This step will result in two groups of individuals; resistant and susceptible individuals.</p>
<p><em>Resistant individuals are the individuals that are not interacting with the pathogen, thus do not have symptoms.</em></p>
<p><em>Susceptible individuals are the individuals that are interacting with the pathogen, thus causing symptoms.</em></p>
<pre class="r"><code># Subsetting the raw dataset by pathogen

test1_09AX27 = test1_selec[which(test1_selec$Strain == &quot;09AX27&quot;),]
test1_93JE3 = test1_selec[which(test1_selec$Strain == &quot;93JE3&quot;),]
test1_P72 = test1_selec[which(test1_selec$Strain == &quot;P72&quot;),]

# From control (Genotype == Robusta) and discriminants (Genotype == discrim$Discrim)

discrim = read.table(&quot;Tab_discrim_vir.txt&quot;,
                      header = TRUE,
                      row.names = NULL)

# Pathogen 09AX27

# Create a new column to differentiate normal individuals from control

test1_09AX27[ ,13] = &quot;NA&quot;

for (i in c(1:nrow(test1_09AX27))){
  if(test1_09AX27$Genotype[i] %in% discrim$Discrim)  # if the genotype name in 09AX27 is the same as those in discrim names in discriminant file
    test1_09AX27[i,13] = &quot;discrim&quot;  # then print discrim in each row of column 13
  
  if(test1_09AX27$Genotype[i] == &quot;Robusta&quot;)  # if the genotype name is robusta
    test1_09AX27[i,13] = &quot;control&quot;  # then print control in each row of column 13
}

# Before graphical inspection, paste the label resistant and susceptible to the relevant individuals

test1_09AX27_nodisc = test1_09AX27[-which(test1_09AX27[ ,13] %in%
                                             c(&quot;control&quot;, &quot;discrim&quot;)), ]

names(test1_09AX27_nodisc)[13] = &quot;Res_vs_sus&quot;

# -5 is a code for &quot;non-measurable&quot; observation, meaning that the individual did not show symptoms at all

for (i in c(1:nrow(test1_09AX27_nodisc))) {
  if(test1_09AX27_nodisc$Laten_24.02.15_gp[i] == -5)
    test1_09AX27_nodisc[i,13] = &quot;Resistant&quot;
  
  if(test1_09AX27_nodisc$Laten_24.02.15_gp[i] != -5)
    test1_09AX27_nodisc[i,13] = &quot;Susceptible&quot;
}

# Graphical inspection resistant vs susceptible individuals

resist_09AX27 = ggplot(test1_09AX27_nodisc, aes(x = Res_vs_sus)) +
  geom_bar(aes(fill = Res_vs_sus)) +
  geom_text(stat = &quot;count&quot;, aes(label = ..count..), vjust = 0.25) +
  labs(title = &quot;Pathogen = 09AX27&quot;,
       x = &quot;Resistant vs Susceptibe&quot;,
       y = &quot;Counts&quot;) +
  scale_fill_manual(values = c(&quot;#87CEEB&quot;, &quot;#FF6A6A&quot;),
                    breaks = c(&quot;Resistant&quot;, &quot;Susceptible&quot;),
                    name = &quot;Resistant vs Susceptible&quot;,
                    labels = c(&quot;Resistant&quot;, &quot;Susceptible&quot;)) +
  theme_classic() +
  theme(axis.title.x = element_blank(),
        legend.position = &quot;none&quot;)</code></pre>
<pre class="r"><code># Pathogen 09AX27

# Create a new column to differentiate normal individuals from discriminants 
# and control (subject for inspection)

# From control (Genotype == Robusta) and discriminants (Genotype == discrim$Discrim)

test1_93JE3[ ,13] = &quot;NA&quot;

for (i in c(1:nrow(test1_93JE3))){
  
  if(test1_93JE3$Genotype[i] %in% discrim$Discrim)
    test1_93JE3[i,13] = &quot;discrim&quot;
  
  if(test1_93JE3$Genotype[i] == &quot;Robusta&quot;)
    test1_93JE3[i,13] = &quot;control&quot;
}

# Before graphical inspection, paste the label resistant and susceptible to
# the relevant individuals

test1_93JE3_nodisc = test1_93JE3[-which(test1_93JE3[ ,13] %in%
                                           c(&quot;control&quot;, &quot;discrim&quot;)), ]

names(test1_93JE3_nodisc)[13] = &quot;Res_vs_sus&quot;

for (i in c(1:nrow(test1_93JE3_nodisc))) {
  
  if(test1_93JE3_nodisc$Laten_24.02.15_gp[i] == -5)
    test1_93JE3_nodisc[i,13] = &quot;Resistant&quot;
  
  
  if(test1_93JE3_nodisc$Laten_24.02.15_gp[i] != -5)
    test1_93JE3_nodisc[i,13] = &quot;Susceptible&quot;
}

# Graphical inspection resistant vs susceptible individuals

resist_93JE3 = ggplot(test1_93JE3_nodisc, aes(x = Res_vs_sus)) +
  geom_bar(aes(fill = Res_vs_sus)) +
  geom_text(stat = &quot;count&quot;, aes(label = ..count..), vjust = 0.25) +
  labs(title = &quot;Pathogen = 09AX27&quot;,
       x = &quot;Resistant vs Susceptibe&quot;,
       y = &quot;Counts&quot;) +
  scale_fill_manual(values = c(&quot;#87CEEB&quot;, &quot;#FF6A6A&quot;),
                    breaks = c(&quot;Resistant&quot;, &quot;Susceptible&quot;),
                    name = &quot;Resistant vs Susceptible&quot;,
                    labels = c(&quot;Resistant&quot;, &quot;Susceptible&quot;)) +
  theme_classic() +
  theme(axis.title.x = element_blank(),
        legend.position = &quot;none&quot;)</code></pre>
<pre class="r"><code># Pathogen 09AX27

# Create a new column to differentiate normal individuals from discriminants
# and control (subject for inspection)

# From control (Genotype == Robusta) and discriminants (Genotype == discrim$Discrim)

test1_P72[ ,13] = &quot;NA&quot;

for (i in c(1:nrow(test1_P72))){
  
  if(test1_P72$Genotype[i] %in% discrim$Discrim)
    test1_P72[i,13] = &quot;discrim&quot;
  
  if(test1_P72$Genotype[i] == &quot;Robusta&quot;)
    test1_P72[i,13] = &quot;control&quot;
}

# Before graphical inspection, paste the label resistant and susceptible to
# the relevant individuals

test1_P72_nodisc = test1_P72[-which(test1_P72[ ,13] %in%
                                       c(&quot;control&quot;, &quot;discrim&quot;)), ]

names(test1_P72_nodisc)[13] = &quot;Res_vs_sus&quot;

for (i in c(1:nrow(test1_P72_nodisc))) {
  
  if(test1_P72_nodisc$Laten_24.02.15_gp[i] == -5)
    test1_P72_nodisc[i,13] = &quot;Resistant&quot;
  
  if(test1_P72_nodisc$Laten_24.02.15_gp[i] != -5)
    test1_P72_nodisc[i,13] = &quot;Susceptible&quot;
}

# Graphical inspection resistant vs susceptible individuals

resist_P72 = ggplot(test1_P72_nodisc, aes(x = Res_vs_sus)) +
  geom_bar(aes(fill = Res_vs_sus)) +
  geom_text(stat = &quot;count&quot;, aes(label = ..count..), vjust = 0.25) +
  labs(title = &quot;Pathogen = 09AX27&quot;,
       x = &quot;Resistant vs Susceptibe&quot;,
       y = &quot;Counts&quot;) +
  scale_fill_manual(values = c(&quot;#87CEEB&quot;, &quot;#FF6A6A&quot;),
                    breaks = c(&quot;Resistant&quot;, &quot;Susceptible&quot;),
                    name = &quot;Resistant vs Susceptible&quot;,
                    labels = c(&quot;Resistant&quot;, &quot;Susceptible&quot;)) +
  theme_classic() +
  theme(axis.title.x = element_blank(),
        legend.position = &quot;none&quot;)

# Combining the plots

res_vs_sus = ggpubr::ggarrange(resist_09AX27, resist_93JE3, resist_P72)

res_vs_sus</code></pre>
<p><img src="preliminary_analysis_files/figure-html/res_vs_sus%20P72-1.png" width="672" /></p>
<p>Note resistant and susceptible are referring to poplar’s responses. The pathogen type on the top of each figure shows the type of pathogen that infected the poplars. This graph shows the share of resistant and susceptible poplars when they were infected with different pathogen types. The poplars were behaving quite similarly. There were around 700 susceptible poplars. The susceptible ones are the poplars that I would study to see whether they were behaving differently from each other. Also, whether they had the chance to fight the pathogen.</p>
<p>Strictly speaking, it is rather tricky to say that these 700 poplars were susceptible. It is more effective to say that these 700 poplars were actively interacting with the pathogen, while the rest were not really interacting with the pathogen. When the poplars are interactive, it means that they can behave differently or they can fight the pathogen with different abilities. Let’s stick with this definition now.</p>
<div id="counting-the-completely-resistant-individuals-meaning-that-they-are-not-interacting-with-the-pathogen" class="section level2">
<h2>Counting the completely resistant individuals (meaning that they are not interacting with the pathogen)</h2>
<pre class="r"><code># Calculating the numbers of resistant individuals for pathogen 09AX27

incomp_09AX27 = plyr::count(test1_09AX27_nodisc$Genotype[
  which(test1_09AX27_nodisc$Laten_24.02.15_gp == -5)])

# Calculating the numbers of resistant individuals for pathogen 93JE3

incomp_93JE3 = plyr::count(test1_93JE3_nodisc$Genotype[
  which(test1_93JE3_nodisc$Laten_24.02.15_gp == -5)])

# Calculating the numbers of resistant individuals for pathogen P72

incomp_P72 = plyr::count(test1_P72_nodisc$Genotype[
  which(test1_P72_nodisc$Laten_24.02.15_gp == -5)])

# Finding the individuals that are resistant across the pathogens

common_resist = data.frame(intersect(incomp_09AX27$x, incomp_93JE3$x))

common_final = data.frame(intersect(common_resist$intersect.incomp_09AX27.x..incomp_93JE3.x., incomp_P72$x))

names(common_final)[1] = &quot;resistant across the pathogens&quot;

common_final</code></pre>
<pre><code>##   resistant across the pathogens
## 1                         BDX-03
## 2                           N-66
## 3                        NL-1210</code></pre>
<p>Turned out three poplar individuals were completely resistant across all the pathogens. It means that they were completely not interacting with the pathogens. Pathogens’ activities were indifferent to them.</p>
</div>
</div>
<div id="graphical-distribution-of-the-resistance-components" class="section level1">
<h1>Graphical distribution of the resistance components</h1>
<p>After inspecting which individuals that were resistant and which were susceptible, I wanted to look into my data as a whole. So, before continuing to data cleaning and EDA, I wanted to see the overall distribution of my dataset.</p>
<pre class="r"><code># Some preparation

test1_selec_NA = test1_selec  # creating a new data frame to avoid confusion

# Replacing -5 to NA because -5 was the code for missing data during
# the experiment

test1_selec_NA =  test1_selec_NA %&gt;% 
  naniar::replace_with_na(replace = list(Laten_24.02.15_gp = -5,
                                         NbSS_24.02.15_gp = -5,
                                         NbSO_24.02.15_gp = -5,
                                         NbPtN_24.02.15_gp = -5,
                                         Taill_05.08.20_gp = c(-5,0)))

## Total uredinia number = adding NbSS and NbSoS

test1_selec_NA$total_NbSS = test1_selec_NA$NbSS_24.02.15_gp + 
  test1_selec_NA$NbSO_24.02.15_gp

## Total black points = substracting NbPtN by point noires avant le test

test1_selec_NA$PtN_real = test1_selec_NA$NbPtN_24.02.15_gp - 
  test1_selec_NA$points.noirs.avant.le.test

# Replacing negative values in PtN_real to 0

test1_selec_NA$PtN_real = replace(test1_selec_NA$PtN_real, 
                                   test1_selec_NA$PtN_real &lt; 0, 0)

## Removing the discriminants and the control

test1_selec_NA[ ,15] = &quot;NA&quot;

for (i in c(1:nrow(test1_selec_NA))){
  
  if(test1_selec_NA$Genotype[i] %in% discrim$Discrim)
    test1_selec_NA[i,15] = &quot;discrim&quot;
  
  if(test1_selec_NA$Genotype[i] == &quot;Robusta&quot;)
    test1_selec_NA[i,15] = &quot;control&quot;
}

test1_NA_nodisc = test1_selec_NA[-which(test1_selec_NA[ ,15] %in%
                                           c(&quot;control&quot;, &quot;discrim&quot;)), ]

## Histogram of each trait

par(mfrow = c(2,2))

test1_loop = data.frame(&quot;LP&quot; = test1_NA_nodisc$Laten_24.02.15_gp,
                         &quot;UN&quot; = test1_NA_nodisc$total_NbSS,
                         &quot;US&quot; = test1_NA_nodisc$Taill_05.08.20_gp)

names(test1_loop)[1:3] = c(&quot;Latent Period&quot;, &quot;Uredinia Number&quot;, &quot;Uredinia Size&quot;)

loop.vector = 1:3

for (i in loop.vector){
  x = test1_loop[,i]
  title = names(test1_loop[i])
  hist(x,
       main = title,
       xlab = &quot;Scores&quot;)
}</code></pre>
<p><img src="preliminary_analysis_files/figure-html/global%20dist%20prep-1.png" width="672" /></p>
<p><strong>Latent period.</strong> By definition, it is the time needed for the individuals to start showing the first symptoms of infection. When poplars were infected with rust, the symptom would be yellow spores that are populating poplar’s leaves. In my study, most poplars started having this symptom on the 9th, 10th, and 11th day after inoculation (i.e. exposure to the pathogen).</p>
<p><strong>Uredinia number</strong>. By definition, it is the number of spores that are populating the poplar’s leaves. On the day 14 after inoculation, I counted the uredinia number. Most poplars had 1 - 40 spores on their leaves by this day.</p>
<p><strong>Uredinia size</strong>. By definition, it is the size of the spores that are populating the poplar’s leaves. On the day 14, I evaluated the uredinia size by scoring it. The score goes from 1 (the smallest) to 5 (the largest). In my study, most poplars had spores with sizes scored 3 - 4.</p>
<p>Note that in this part I just summarized the distribution of the resistance components from my dataset as a whole.</p>
<p>Remember that I had 5 blocks which served as repetitions to avoid bias. In this section, I acknowledged the individuals in 5 blocks as different individuals. The idea was to see how they were behaving in general and what distribution I could expect from my data. However, after I clean the data, I would get one value averaged across 5 blocks for an individual’s resistance components.</p>
</div>
<div id="graphical-distribution-of-the-resistance-components-depending-on-the-pathogen-types" class="section level1">
<h1>Graphical distribution of the resistance components depending on the pathogen types</h1>
<p>Now I want to crosscheck the previous distribution (that was not considering the different pathogens I used) with the following distribution where I sparse the distribution based on the pathogens. Will the resistance components have the same distribution as before?</p>
<pre class="r"><code>## Subsetting the clean dataset based on pathogen

s09AX27_clean = test1_NA_nodisc[which(test1_NA_nodisc$Strain == &quot;09AX27&quot;),]
s93JE3_clean = test1_NA_nodisc[which(test1_NA_nodisc$Strain == &quot;93JE3&quot;),]
sP72_clean = test1_NA_nodisc[which(test1_NA_nodisc$Strain == &quot;P72&quot;),]</code></pre>
<div id="graphical-inspection-pathogen-09ax27" class="section level2">
<h2>Graphical inspection pathogen 09AX27</h2>
<pre class="r"><code>s09AX27_loop = data.frame(&quot;LP&quot; = s09AX27_clean$Laten_24.02.15_gp,
                           &quot;UN&quot; = s09AX27_clean$total_NbSS,
                           &quot;US&quot; = s09AX27_clean$Taill_05.08.20_gp)
loop.vector = 1:3

par(mfrow = c(2,2))

for (i in loop.vector){
  x = s09AX27_loop[,i]
  title = names(s09AX27_loop[i])
  hist(x,
       main = paste(&quot;09AX27&quot;, title),
       xlab = &quot;Scores&quot;)
}</code></pre>
<p><img src="preliminary_analysis_files/figure-html/trait%20dist%2009AX27-1.png" width="672" /></p>
</div>
<div id="graphical-inspection-pathogen-93je3" class="section level2">
<h2>Graphical inspection pathogen 93JE3</h2>
<pre class="r"><code>s93JE3_loop = data.frame(&quot;LP&quot; = s93JE3_clean$Laten_24.02.15_gp,
                          &quot;UN&quot; = s93JE3_clean$total_NbSS,
                          &quot;US&quot; = s93JE3_clean$Taill_05.08.20_gp)

par(mfrow = c(2,2))

for (i in loop.vector){
  x = s93JE3_loop[,i]
  title = names(s93JE3_loop[i])
  hist(x,
       main = paste(&quot;93JE3&quot;, title),
       xlab = &quot;Scores&quot;)
}</code></pre>
<p><img src="preliminary_analysis_files/figure-html/trait%20dist%2093JE3-1.png" width="672" /></p>
</div>
<div id="graphical-inspection-pathogen-p72" class="section level2">
<h2>Graphical inspection pathogen P72</h2>
<pre class="r"><code>sP72_loop = data.frame(&quot;LP&quot; = sP72_clean$Laten_24.02.15_gp,
                        &quot;UN&quot; = sP72_clean$total_NbSS,
                        &quot;US&quot; = sP72_clean$Taill_05.08.20_gp)

par(mfrow = c(2,2))

for (i in loop.vector){
  x = sP72_loop[,i]
  title = names(sP72_loop[i])
  hist(x,
       main = paste(&quot;P72&quot;, title),
       xlab = &quot;Scores&quot;)
}</code></pre>
<p><img src="preliminary_analysis_files/figure-html/trait%20dist%20P72-1.png" width="672" /></p>
<p>When I sparse the distribution of each variable based on the pathogens, the variables still follow the similar pattern as the previous one (without sparsing based on the pathogens). So probably it is a normal pattern in the interaction between poplars and rust fungus.</p>
<p>If I have to point at the differences in poplar’s resistance across pathogen types…</p>
<p><strong>Latent period</strong>. Poplars that were infected by 93JE3 and P72 started showing symptoms in much earlier days than the poplars infected by 09AX27</p>
<p><strong>Uredinia number</strong>. Poplars that were infected by 93JE3 and P72 were populated with more spores than in poplars infected by 09AX27</p>
<p><strong>Uredinia size</strong>. The spore size in the poplars infected by P72 had the smallest size (score = 3).</p>
<p><strong>Bottom line</strong>. The key takeaway from this analysis is poplars could resist the population of the spores from pathogen 09AX27. When the poplar leaves were populated by spores, poplar could still resist the spore population from pathogen 09AX27, but not from 93JE3 and P72. Approaching day 14 (incubation period = 14 days), poplars could not resist the growth of pathogen 09AX27 anymore, but could resist the growth of pathogen 93JE3, and especially pathogen P72.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
